<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Development &mdash; gammapy v0.2</title>
    
    <link rel="stylesheet" href="../_static/gammapy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="gammapy v0.2" href="../index.html" />
    <link rel="next" title="Changelog" href="../changelog.html" />
    <link rel="prev" title="Credit" href="../credit.html" />

<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="../_static/copybutton.js"></script>


<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://gammapy.readthedocs.org/en/latest/development/" />

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "gammapy",
    version: "v0.2",
    language: "en",
    page: "development/index",
    builder: "sphinx",
    theme: "bootstrap-astropy",
    docroot: "/docs/",
    source_suffix: ".rst",
    api_host: "https://readthedocs.org",
    commit: "9738ffd45cc7ff63ec8b846e4288f5212b4717db"
  }
  // Old variables
  var doc_version = "v0.2";
  var doc_slug = "gammapy";
  var page_name = "development/index";
  var html_theme = "bootstrap-astropy";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);


  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->
<!-- end RTD <extrahead> -->

  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">gamma</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="http://gammapy.readthedocs.io/en/v0.2/search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../changelog.html" title="Changelog">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../credit.html" title="Credit">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">gammapy v0.2</a>
	 &raquo;
      </li>
      
      <li>Development</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="development">
<span id="id1"></span><h1>Development<a class="headerlink" href="index.html#development" title="Permalink to this headline">¶</a></h1>
<p>This page is a collection of notes for Gammapy developers and maintainers.</p>
<p>Note that Astropy has very extensive developer documentation
<a class="reference external" href="http://astropy.readthedocs.org/en/latest/#developer-documentation">here</a>,
this page should only mention Gammapy-specific things.</p>
<div class="section" id="where-should-i-import-from">
<span id="development-import-from"></span><h2>Where should I import from?<a class="headerlink" href="index.html#where-should-i-import-from" title="Permalink to this headline">¶</a></h2>
<p>You should import from the &#8220;end-user namespaces&#8221;, not the &#8220;implementation module&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">gammapy.data</span> <span class="kn">import</span> <span class="n">EventList</span>  <span class="c"># good</span>
<span class="kn">from</span> <span class="nn">gammapy.data.event_list</span> <span class="kn">import</span> <span class="n">EventList</span> <span class="c"># bad</span>

<span class="kn">from</span> <span class="nn">gammapy.stats</span> <span class="kn">import</span> <span class="n">cash</span>  <span class="c"># good</span>
<span class="kn">from</span> <span class="nn">gammapy.stats.fit_statistics</span> <span class="kn">import</span> <span class="n">cash</span>  <span class="c"># bad</span>
</pre></div>
</div>
<p>The end-user namespace is the location that is shown in the API docs, i.e. you can
use the Sphinx full-text search to quickly find it.</p>
<p>To make code maintenance easier, the implementation of the functions and classes is
spread across multiple modules (<tt class="docutils literal"><span class="pre">.py</span></tt> files), but the user shouldn&#8217;t care about their
names, that would be too much to remember.</p>
<p>The only reason to import from a module directly is if you need to access a private
function, class or variable (something that is not listed in <tt class="docutils literal"><span class="pre">__all__</span></tt> and thus not
imported into the end-user namespace.</p>
<p>Note that this means that in the definition of an &#8220;end-user namespace&#8221;, e.g. in the
<tt class="docutils literal"><span class="pre">gammapy/data/__init__.py</span></tt> file, the imports have to be sorted in a way such that
modules in <tt class="docutils literal"><span class="pre">gammapy/data</span></tt> are loaded when imported from other modules in that sub-package.</p>
</div>
<div class="section" id="why-we-don-t-sub-class-other-data-classes">
<span id="development-data-subclasses"></span><h2>Why we don&#8217;t sub-class other data classes<a class="headerlink" href="index.html#why-we-don-t-sub-class-other-data-classes" title="Permalink to this headline">¶</a></h2>
<p>We have considered re-using data classes developed by others,
namely <a class="reference external" href="http://docs.astropy.org/en/latest/api/astropy.nddata.NDData.html#astropy.nddata.NDData" title="(in Astropy v1.1.dev12316)"><tt class="xref py py-obj docutils literal"><span class="pre">NDData</span></tt></a> and the
<a class="reference external" href="http://spectral-cube.readthedocs.org/en/latest/index.html">spectral_cube.SpectralCube</a>
classes.</p>
<p>But in both cases, the data model didn&#8217;t really fit our use cases for gamma-ray astronomy
and so we decided to write our own data classes from scratch.</p>
<p>Here&#8217;s some issues where this was discussed:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/radio-astro-tools/spectral-cube/issues/110">https://github.com/radio-astro-tools/spectral-cube/issues/110</a></li>
<li><a class="reference external" href="https://github.com/astropy/astropy/pull/2855#issuecomment-52610106">https://github.com/astropy/astropy/pull/2855#issuecomment-52610106</a></li>
</ul>
</div>
<div class="section" id="functions-returning-several-values">
<span id="development-result-object"></span><h2>Functions returning several values<a class="headerlink" href="index.html#functions-returning-several-values" title="Permalink to this headline">¶</a></h2>
<p>Functions that return more than a single value shouldn&#8217;t return a list
or dictionary of values but rather a Python Bunch result object. A Bunch
is similar to a dict, except that it allows attribute access to the result
values. The approach is the same as e.g. the use of <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult" title="(in SciPy v0.15.1)"><tt class="xref py py-obj docutils literal"><span class="pre">OptimizeResult</span></tt></a>.
An example of how Bunches are used in gammapy is given by the <a class="reference internal" href="../api/gammapy.detect.TSMapResult.html#gammapy.detect.TSMapResult" title="gammapy.detect.TSMapResult"><tt class="xref py py-obj docutils literal"><span class="pre">TSMapResult</span></tt></a>
class.</p>
</div>
<div class="section" id="python-2-and-3-support">
<span id="development-python2and3"></span><h2>Python 2 and 3 support<a class="headerlink" href="index.html#python-2-and-3-support" title="Permalink to this headline">¶</a></h2>
<p>We support Python 2.7 and 3.3 or later using a single code base.
This is the strategy adopted by most scientific Python projects and a good starting point to learn about it is
<a class="reference external" href="http://python3porting.com/noconv.html">here</a> and
<a class="reference external" href="http://astropy.readthedocs.org/en/latest/development/codeguide.html#writing-portable-code-for-python-2-and-3">here</a>.</p>
<p>For developers, it would have been nice to only support Python 3 in Gammapy.
But the CIAO and Fermi Science tools software are distributed with Python 2.7
and probably never will be updated to Python 3.
Plus many potential users will likely keep running on Python 2.7 for many years
(see e.g. <a class="reference external" href="http://ipython.org/usersurvey2013.html#python-versions">this survey</a>).</p>
<p>The decision to drop Python 2.6 and 3.2 support was made in August 2014 just before the Gammapy 0.1 release,
based on a few scientific Python user surveys on the web that show that only a small minority are still
using such an old version, so that it&#8217;s not worth the developer and maintainer effort to test
these old versions and to find workarounds for their missing features or bugs.</p>
</div>
<div class="section" id="wipe-readthedocs">
<span id="development-wipe-readthedocs"></span><h2>Wipe readthedocs<a class="headerlink" href="index.html#wipe-readthedocs" title="Permalink to this headline">¶</a></h2>
<p>As described <a class="reference external" href="http://read-the-docs.readthedocs.org/en/latest/builds.html#deleting-a-stale-or-broken-build-environment">here</a>,
if the docs on readthedocs show old stuff, you need to first log in <a class="reference external" href="https://readthedocs.org/accounts/login/">here</a>
and then wipe it to create a fresh / clean version by hitting this URL:</p>
<div class="highlight-python"><div class="highlight"><pre>http://readthedocs.org/wipe/gammapy/latest/
</pre></div>
</div>
<p>and then clicking the &#8220;wipe version&#8221; button.</p>
<p>You don&#8217;t get a confirmation that the wipe has taken place, but you can check
<a class="reference external" href="https://readthedocs.org/builds/gammapy/">here</a> (wait a few minutes)
and if needed manually start a new build by going
<a class="reference external" href="https://readthedocs.org/projects/gammapy/">here</a> and clicking the &#8220;Build&#8221; button.</p>
</div>
<div class="section" id="skip-unit-tests-for-some-astropy-versions">
<span id="development-skip-tests"></span><h2>Skip unit tests for some Astropy versions<a class="headerlink" href="index.html#skip-unit-tests-for-some-astropy-versions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy.tests.helper</span> <span class="kn">import</span> <span class="n">pytest</span>

<span class="n">ASTROPY_VERSION</span> <span class="o">=</span> <span class="p">(</span><span class="n">astropy</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">major</span><span class="p">,</span> <span class="n">astropy</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">minor</span><span class="p">)</span>
<span class="nd">@pytest.mark.xfail</span><span class="p">(</span><span class="n">ASTROPY_VERSION</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">reason</span><span class="o">=</span><span class="s">&quot;Astropy API change&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_something</span><span class="p">():</span>
   <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="check-html-links">
<span id="development-check-html-links"></span><h2>Check HTML links<a class="headerlink" href="index.html#check-html-links" title="Permalink to this headline">¶</a></h2>
<p>There&#8217;s two ways to check the docs for broken links.</p>
<p>This will check external links (not nice because you have to install first):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python setup.py install
<span class="nv">$ </span><span class="nb">cd </span>docs<span class="p">;</span> make linkcheck
</pre></div>
</div>
<p>To check all internal and external links use this <a class="reference external" href="https://github.com/wummel/linkchecker">linkchecker</a>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>pip install linkchecker
<span class="nv">$ </span>linkchecker --check-extern docs/_build/html/index.html
</pre></div>
</div>
<p>Because Sphinx doesn&#8217;t warn about some broken internal links for some reason,
we run <tt class="docutils literal"><span class="pre">linkchecker</span> <span class="pre">docs/_build/html/index.html</span></tt> on travis-ci,
but not with the <tt class="docutils literal"><span class="pre">--check-extern</span></tt> option as that would probably fail
randomly quite often whenever one of the external websites is down.</p>
</div>
<div class="section" id="make-a-gammapy-release">
<span id="development-release-gammapy"></span><h2>Make a Gammapy release<a class="headerlink" href="index.html#make-a-gammapy-release" title="Permalink to this headline">¶</a></h2>
<p>To make a Gammapy release, follow the instructions how to release an Astropy affiliated package
<a class="reference external" href="http://astropy.readthedocs.org/en/latest/development/affiliated-packages.html#releasing-an-affiliated-package">here</a>.</p>
<p>Here&#8217;s some additional notes / things to check:</p>
<ul class="simple">
<li>Update the Gammapy version number on the <a class="reference internal" href="../index.html#gammapy-welcome"><em>What is Gammapy?</em></a> section and the <a class="reference internal" href="../install.html#install"><em>Installation</em></a> section.</li>
<li>Mention release in the <a class="reference internal" href="../index.html#gammapy-news"><em>News</em></a> section.</li>
<li>Check external HTML links (see <a class="reference internal" href="index.html#development-check-html-links"><em>here</em></a>).</li>
<li>Check that the tarball from PyPI is OK.</li>
<li>Check that the new release shows up on readthedocs.</li>
<li>Send announcement to Gammapy mailing list, Astropy mailing list and Twitter.</li>
</ul>
</div>
<div class="section" id="other-codes">
<h2>Other codes<a class="headerlink" href="index.html#other-codes" title="Permalink to this headline">¶</a></h2>
<p>These projects are on Github, which is great because
it has full-text search and git history view:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/gammapy/gammapy">https://github.com/gammapy/gammapy</a></li>
<li><a class="reference external" href="https://github.com/gammapy/gammapy-extra">https://github.com/gammapy/gammapy-extra</a></li>
<li><a class="reference external" href="https://github.com/astropy/astropy">https://github.com/astropy/astropy</a></li>
<li><a class="reference external" href="https://github.com/astropy/photutils">https://github.com/astropy/photutils</a></li>
<li><a class="reference external" href="https://github.com/gammalib/gammalib">https://github.com/gammalib/gammalib</a></li>
<li><a class="reference external" href="https://github.com/ctools/ctools">https://github.com/ctools/ctools</a></li>
<li><a class="reference external" href="https://github.com/sherpa/sherpa">https://github.com/sherpa/sherpa</a></li>
<li><a class="reference external" href="https://github.com/zblz/naima">https://github.com/zblz/naima</a></li>
<li><a class="reference external" href="https://github.com/woodmd/gammatools">https://github.com/woodmd/gammatools</a></li>
<li><a class="reference external" href="https://github.com/kialio/VHEObserverTools">https://github.com/kialio/VHEObserverTools</a></li>
</ul>
<p>These are unofficial, unmaintained copies on open codes on Github:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/Xarthisius/yt-drone">https://github.com/Xarthisius/yt-drone</a></li>
<li><a class="reference external" href="https://github.com/cdeil/Fermi-ScienceTools-mirror">https://github.com/cdeil/Fermi-ScienceTools-mirror</a></li>
<li><a class="reference external" href="https://github.com/cdeil/kapteyn-mirror">https://github.com/cdeil/kapteyn-mirror</a></li>
</ul>
</div>
<div class="section" id="what-checks-and-conversions-should-i-do-for-inputs">
<h2>What checks and conversions should I do for inputs?<a class="headerlink" href="index.html#what-checks-and-conversions-should-i-do-for-inputs" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy we assume that
<a class="reference external" href="https://mail.python.org/pipermail/tutor/2003-October/025932.html">&#8220;we&#8217;re all consenting adults&#8221;</a>,
which means that when you write a function you should write it like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Do something.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : `numpy.ndarray`</span>
<span class="sd">        Data</span>
<span class="sd">    option : {&#39;this&#39;, &#39;that&#39;}</span>
<span class="sd">        Option</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s">&#39;this&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">data</span>
    <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s">&#39;that&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">data</span> <span class="o">**</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Invalid option: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">option</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
<ul>
<li><p class="first"><strong>Don&#8217;t always add `isinstance` checks for everything</strong> ... assume the caller passes valid inputs,
... in the example above this is not needed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Don&#8217;t always add `numpy.asanyarray` calls for all array-like inputs</strong> ... the caller can do this if
it&#8217;s really needed ... in the example above document <tt class="docutils literal"><span class="pre">data</span></tt> as type <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.9)"><tt class="xref py py-obj docutils literal"><span class="pre">ndarray</span></tt></a>
instead of array-like and don&#8217;t put this line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Do always add an `else` clause to your `if`-`elif` clauses</strong> ... this is boilerplate code,
but not adding it would mean users get this error if they pass an invalid option:</p>
<div class="highlight-python"><div class="highlight"><pre>UnboundLocalError: local variable &#39;out&#39; referenced before assignment
</pre></div>
</div>
</li>
</ul>
<p>Now if you really want, you can add the <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.asanyarray.html#numpy.asanyarray" title="(in NumPy v1.9)"><tt class="xref py py-obj docutils literal"><span class="pre">numpy.asanyarray</span></tt></a> and <a class="reference external" href="http://docs.python.org/library/functions.html#isinstance" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">isinstance</span></tt></a> checks
for functions that end-users might often use for interactive work to provide them with
better exception messages, but doing it everywhere would mean 1000s of lines of boilerplate
code and take the fun out of Python programming.</p>
</div>
<div class="section" id="float-data-type-32-bit-or-64-bit">
<h2>Float data type: 32 bit or 64 bit?<a class="headerlink" href="index.html#float-data-type-32-bit-or-64-bit" title="Permalink to this headline">¶</a></h2>
<p>Most of the time what we want is to use 32 bit to store data on disk and 64 bit to do
computations in memory.</p>
<p>Using 64 bit to store data and results (e.g. large images or cubes) on disk would mean
a factor ~2 increase in file sizes and slower I/O, but I&#8217;m not aware of any case
where we need that precision.</p>
<p>On the other hand, doing computations with millions and billions of pixels very frequently
results in inaccurate results ... e.g. the likelihood is the sum over per-pixel likelihoods
and using 32-bit will usually result in erratic and hard-to-debug optimizer behaviour
and even if the fit works incorrect results.</p>
<p>Now you shouldn&#8217;t put this line at the top of every function ... assume the caller
passes 64-bit data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>But you should add explicit type conversions to 64 bit when reading float data from files
and explicit type conversions to 32 bit before writing to file.</p>
</div>
<div class="section" id="clobber-or-overwrite">
<h2>Clobber or overwrite?<a class="headerlink" href="index.html#clobber-or-overwrite" title="Permalink to this headline">¶</a></h2>
<p>In Gammapy we use on <tt class="docutils literal"><span class="pre">overwrite</span></tt> bool option for <a class="reference internal" href="../scripts/index.html#module-gammapy.scripts" title="gammapy.scripts"><tt class="xref py py-obj docutils literal"><span class="pre">gammapy.scripts</span></tt></a> and functions that
write to files.</p>
<p>Why not use <tt class="docutils literal"><span class="pre">clobber</span></tt> instead?
After all the
<a class="reference external" href="http://heasarc.gsfc.nasa.gov/ftools/ftools_menu.html">FTOOLS</a>
always use <tt class="docutils literal"><span class="pre">clobber</span></tt>.</p>
<p>The reason is that <tt class="docutils literal"><span class="pre">overwrite</span></tt> is clear to everyone, but <tt class="docutils literal"><span class="pre">clobber</span></tt> is defined by the dictionary
(e.g. see <a class="reference external" href="http://dictionary.reference.com/browse/clobber">here</a>)
as &#8220;to batter severely; strike heavily. to defeat decisively. to denounce or criticize vigorously.&#8221;
and isn&#8217;t intuitively clear to new users.</p>
<p>Astropy uses both <tt class="docutils literal"><span class="pre">clobber</span></tt> and <tt class="docutils literal"><span class="pre">overwrite</span></tt> in various places at the moment.
For Gammapy we can re-visit this decision before the 1.0 release, but for now,
please be consistent and use <tt class="docutils literal"><span class="pre">overwrite</span></tt>.</p>
</div>
<div class="section" id="pixel-coordinate-convention">
<h2>Pixel coordinate convention<a class="headerlink" href="index.html#pixel-coordinate-convention" title="Permalink to this headline">¶</a></h2>
<p>All code in Gammapy should follow the Astropy pixel coordinate convention that the center of the first pixel
has pixel coordinates <tt class="docutils literal"><span class="pre">(0,</span> <span class="pre">0)</span></tt> (and not <tt class="docutils literal"><span class="pre">(1,</span> <span class="pre">1)</span></tt> as shown e.g. in ds9).
It&#8217;s currently documented <a class="reference external" href="http://photutils.readthedocs.org/en/latest/photutils/overview.html#coordinate-conventions">here</a>
but I plan to document it in the Astropy docs soon (see <a class="reference external" href="https://github.com/astropy/astropy/issues/2607">issue 2607</a>).</p>
<p>You should use <tt class="docutils literal"><span class="pre">origin=0</span></tt> when calling any of the pixel to world or world to pixel coordinate transformations in <a class="reference external" href="http://docs.astropy.org/en/latest/wcs/index.html#module-astropy.wcs" title="(in Astropy v1.1.dev12316)"><tt class="xref py py-obj docutils literal"><span class="pre">astropy.wcs</span></tt></a>.</p>
</div>
<div class="section" id="when-to-use-c-or-cython-or-numba-for-speed">
<h2>When to use C or Cython or Numba for speed<a class="headerlink" href="index.html#when-to-use-c-or-cython-or-numba-for-speed" title="Permalink to this headline">¶</a></h2>
<p>Most of Gammapy is written using Python and Numpy array expressions calling functions (e.g. from Scipy)
that operate on Numpy arrays.
This is often nice because it means that algorithms can be implemented with few lines of high-level code,</p>
<p>There is a very small fraction of code though (one or a few percent) where this results in code that is
either cumbersome or too slow. E.g. to compute TS or upper limit images, one needs to do a root finding
method with different number of iterations for each pixel ... that&#8217;s impossible (or at least very
cumbersome / hard to read) to implement with array expressions and Python loops over pixels are slow.</p>
<p>In these cases we encourage the use of <a class="reference external" href="http://cython.org/">Cython</a> or <a class="reference external" href="http://numba.pydata.org/">Numba</a>,
or writing the core code in C and exposing it to Python via Cython.
These are popular and simple ways to get C speed from Python.</p>
<p>To use several CPU cores consider using the Python standard library
<a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a> module.</p>
<p>Note that especially the use of Numba should be considered an experiment.
It is a very nice, but new technology and no-one uses it in production.
Before the Gammapy 1.0 release we will re-evaluate the status of Numba and decide whether it&#8217;s
an optional dependency we use for speed, or whether we use the much more established Cython
(Scipy, scikit-image, Astropy, ... all use Cython).</p>
<p>At the time of writing (April 2015), the TS map computation code uses Cython and multiprocessing
and Numba is not used yet.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="index.html#">Development</a><ul>
<li><a class="reference internal" href="index.html#where-should-i-import-from">Where should I import from?</a></li>
<li><a class="reference internal" href="index.html#why-we-don-t-sub-class-other-data-classes">Why we don&#8217;t sub-class other data classes</a></li>
<li><a class="reference internal" href="index.html#functions-returning-several-values">Functions returning several values</a></li>
<li><a class="reference internal" href="index.html#python-2-and-3-support">Python 2 and 3 support</a></li>
<li><a class="reference internal" href="index.html#wipe-readthedocs">Wipe readthedocs</a></li>
<li><a class="reference internal" href="index.html#skip-unit-tests-for-some-astropy-versions">Skip unit tests for some Astropy versions</a></li>
<li><a class="reference internal" href="index.html#check-html-links">Check HTML links</a></li>
<li><a class="reference internal" href="index.html#make-a-gammapy-release">Make a Gammapy release</a></li>
<li><a class="reference internal" href="index.html#other-codes">Other codes</a></li>
<li><a class="reference internal" href="index.html#what-checks-and-conversions-should-i-do-for-inputs">What checks and conversions should I do for inputs?</a></li>
<li><a class="reference internal" href="index.html#float-data-type-32-bit-or-64-bit">Float data type: 32 bit or 64 bit?</a></li>
<li><a class="reference internal" href="index.html#clobber-or-overwrite">Clobber or overwrite?</a></li>
<li><a class="reference internal" href="index.html#pixel-coordinate-convention">Pixel coordinate convention</a></li>
<li><a class="reference internal" href="index.html#when-to-use-c-or-cython-or-numba-for-speed">When to use C or Cython or Numba for speed</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/development/index.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="index.html#">Back to Top</a></p>
  <p>
    &copy; Copyright 2015, The Gammapy developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2. &nbsp;
    Last built 13 Apr 2015. <br/>
  </p>
</footer>
  </body>
</html>